\chapter{TLS Connections}\label{appendix.tls}

The Protection Profiles defines the cipher suites required for TLS
connections. The TOE uses provides exactly those cipher suites and no other.
\tableref{tab:ciphersuites} lists these cipher
suites. \tableref{tab:elliptic-curves} lists the elliptic curves used for ECDHE.

\begin{table}[htb]
  \centering
  \begin{tabularx}{1\linewidth}{>{\small}X>{\ttfamily}c*{2}{C{1.85cm}}}
    \toprule Algorithmen / Cipher Suite & \textrm{IANA\,ID} & TLS\,1.2\newline\cite{rfc5246}
    \tabularnewline \midrule
    TLS\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA        & 0x00,\,0x33  & \tcheck \tabularnewline
    TLS\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA        & 0x00,\,0x39  & \tcheck \tabularnewline
    TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA      & 0xc0,\,0x13  & \tcheck \tabularnewline
    TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA      & 0xc0,\,0x14  & \tcheck \tabularnewline
    TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256   & 0xc0,\,0x27  & \tcheck \tabularnewline
    TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384   & 0xc0,\,0x28  & \tcheck \tabularnewline
    TLS\_ECDHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256   & 0xc0,\,0x2f  & \tcheck \tabularnewline
    TLS\_ECDHE\_RSA\_WITH\_AES\_256\_GCM\_SHA384   & 0xc0,\,0x30  & \tcheck \tabularnewline
    \bottomrule
  \end{tabularx}
  \caption{Cipher suites for TLS connections}
  \label{tab:ciphersuites}
\end{table}

\begin{table}[htb]
  \centering
  \begin{tabularx}{0.7\linewidth}{X>{\ttfamily}cc}
    \toprule Elliptic curve & \textrm{IANA\,ID} & Standard \\
    \midrule
    secp256r1 (P-256) & 23 & \cite{rfc8422, X9.62} \\
    secp384r1 (P-384) & 24 & \cite{rfc8422, X9.62} \\
    brainpoolP256r1   & 26 & \cite{rfc7027} \\
    brainpoolP384r1   & 27 & \cite{rfc7027} \\
    \bottomrule
  \end{tabularx}
  \caption{Elliptic curves for TLS connections}
  \label{tab:elliptic-curves}
\end{table}


The TOE communicates with other trusted IT products over secure
connections. Integrity and confidentiality of these connections is ensured by
TLS~v1.2. \tableref{tab:tlsconnections} lists all connections the TOE can
participate in. \tableref{tab:tlslegende} describes the columns of this table.


\begin{table}[htb]
  \renewcommand{\arraystretch}{1.5}
  \centering
  \begin{tabularx}{0.9\linewidth}{lX}
    \toprule Column & Descriptions\\ \midrule
    ID & Smybolic name of this connection \\
    Interface & Logical interface whose communication is secured.\\
    Role & Describes client/serer role of the TOE.\\
    Peer & Describes the peer in this TLS connection.\\
    Protocol & Application protocol used in this connection. \\
    \secitemformat{Subsystem::Module} & Name of the subsystem and the module from which the connection originates or that accepts the connections.\\
    Port & IP-Port that the TOE opens for the connection. If the TOE is client, ``dyn.'' stands for ephemeral port assignment. ``config'' stands for a confgurable port number.\\
    Identity of TOE & Certificate that the TOE uses to authenticate itself to the peer.\\
    Identity of Peer & Certificate that the peer uses to authenticate itself to the TOE.\\
    Authentication by & Process, data source or subsystem/module used by the TOE for authentication/verification.\\
    \bottomrule
  \end{tabularx}
  \hypertarget{tab:o.tlslegende}{\caption{Legend for TLS connections}}
  \label{tab:tlslegende}
\end{table}





\afterpage{%
  \clearpage% Flush earlier floats (otherwise order might not be correct)
  \begin{landscape}% Landscape page
    \centering % Center table
    {
      \input{../common/tls_connections.tex}
    }
    % \captionof{table}{Security Functions / Security Function Requirements}% Add 'table' caption
  \end{landscape}
  \clearpage% Flush page
}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: shared
%%% TeX-engine: luatex
%%% TeX-parse-self: t
%%% TeX-auto-save: t
%%% End:
